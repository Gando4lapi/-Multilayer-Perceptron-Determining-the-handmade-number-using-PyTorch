# Determining-the-handmade-number-using-PyTorch

–ü—Ä–æ–µ–∫—Ç –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä—É–∫–æ–ø–∏—Å–Ω—ã—Ö —Ü–∏—Ñ—Ä (–æ—Ç 0 –¥–æ 9) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ PyTorch –∏ –¥–∞—Ç–∞—Å–µ—Ç–∞ MNIST.

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–û –ø—Ä–æ–µ–∫—Ç–µ](#–æ-–ø—Ä–æ–µ–∫—Ç–µ)
- [–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏](#—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏)
- [–£—Å—Ç–∞–Ω–æ–≤–∫–∞](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞)
- [–û–±—ä—è—Å–Ω–µ–Ω–∏–µ –∫–æ–¥–∞](#–æ–±—ä—è—Å–Ω–µ–Ω–∏–µ-–∫–æ–¥–∞)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–∏](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-–º–æ–¥–µ–ª–∏)
- [–†–µ–∑—É–ª—å—Ç–∞—Ç—ã](#—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã)
- [–ê–≤—Ç–æ—Ä](#–∞–≤—Ç–æ—Ä)

## üéØ –û –ø—Ä–æ–µ–∫—Ç–µ

–¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞ ‚Äî –Ω–∞—É—á–∏—Ç—å –∫–æ–º–ø—å—é—Ç–µ—Ä —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞—Ç—å —Ä—É–∫–æ–ø–∏—Å–Ω—ã–µ —Ü–∏—Ñ—Ä—ã —Å –ø–æ–º–æ—â—å—é –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏. –ò—Å–ø–æ–ª—å–∑—É–µ–º –¥–∞—Ç–∞—Å–µ—Ç MNIST ‚Äî –ø–æ–ø—É–ª—è—Ä–Ω—ã–π –Ω–∞–±–æ—Ä –∏–∑ 70,000 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Ü–∏—Ñ—Ä —Ä–∞–∑–º–µ—Ä–æ–º 28x28 –ø–∏–∫—Å–µ–ª–µ–π.

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç –ø—Ä–æ–µ–∫—Ç:**
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞—Ç–∞—Å–µ—Ç MNIST
- –û–±—É—á–∞–µ—Ç –ø—Ä–æ—Å—Ç—É—é –Ω–µ–π—Ä–æ–Ω–Ω—É—é —Å–µ—Ç—å
- –¢–µ—Å—Ç–∏—Ä—É–µ—Ç –º–æ–¥–µ–ª—å –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ—á–Ω–æ—Å—Ç—å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è
- –í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–∏–º–µ—Ä—ã —Ü–∏—Ñ—Ä

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Python 3.x**
- **PyTorch** - –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π
- **TorchVision** - –∑–∞–≥—Ä—É–∑–∫–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- **NumPy** - —Ä–∞–±–æ—Ç–∞ —Å –º–∞—Å—Å–∏–≤–∞–º–∏ –∏ —á–∏—Å–ª–∞–º–∏
- **Matplotlib** - —Å–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–π
- **tqdm** - –∫—Ä–∞—Å–∏–≤—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–≥—Ä–µ—Å—Å–∞

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:**
```bash
git clone https://github.com/Gando4lapi/-Multilayer-Perceptron-Determining-the-handmade-number-using-PyTorch
cd -Multilayer-Perceptron-Determining-the-handmade-number-using-PyTorch
```

2. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
```bash
pip install torch torchvision numpy matplotlib tqdm
```

## üìñ –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –∫–æ–¥–∞

–í –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–º –∫–æ–¥–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è –º–Ω–æ–≥–æ—Å–ª–æ–π–Ω—ã–π –ø–µ—Ä—Å–µ–ø—Ç—Ä–æ–Ω –¥–ª—è MNIST: –∏–º–ø–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏, –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–ª–∞—Å—Å –º–æ–¥–µ–ª–∏ —Å —Ç—Ä–µ–º—è –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã–º–∏ —Å–ª–æ—è–º–∏ –∏ ReLU –º–µ–∂–¥—É –Ω–∏–º–∏, –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –¥–∞—Ç–∞—Å–µ—Ç, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –∑–∞–≥—Ä—É–∑—á–∏–∫–∏, —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä.

### –ò–º–ø–æ—Ä—Ç—ã
import torch ‚Äî –ø–æ–¥–∫–ª—é—á–∞–µ—Ç —è–¥—Ä–æ PyTorch: —Ç–µ–Ω–∑–æ—Ä—ã, –∞–≤—Ç–æ–¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏—Ä–æ–≤–∞–Ω–∏–µ, —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ CPU/GPU.

import torch.nn as nn ‚Äî –º–æ–¥—É–ª—å –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π —Å –≥–æ—Ç–æ–≤—ã–º–∏ —Å–ª–æ—è–º–∏ –∏ –±–∞–∑–æ–≤—ã–º –∫–ª–∞—Å—Å–æ–º nn.Module.

import torch.nn.functional as F ‚Äî —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ –æ–ø–µ—Ä–∞—Ü–∏–π (ReLU, Conv2d –∏ —Ç.–¥.); –≤ —Ç–µ–∫—É—â–µ–º —Ñ—Ä–∞–≥–º–µ–Ω—Ç–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –Ω–æ —á–∞—Å—Ç–æ –≤—ã–∑—ã–≤–∞—é—Ç F.relu.

from torchvision import datasets, transforms ‚Äî –Ω–∞–±–æ—Ä—ã –¥–∞–Ω–Ω—ã—Ö –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π; –æ—Ç—Å—é–¥–∞ –±–µ—Ä—ë—Ç—Å—è MNIST –∏ –ø—Ä–µ–≤—Ä–∞—â–µ–Ω–∏–µ –≤ —Ç–µ–Ω–∑–æ—Ä—ã.

import numpy as np ‚Äî –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ —á–∏—Å–ª–µ–Ω–Ω—ã—Ö –º–∞—Å—Å–∏–≤–æ–≤; –ø—Ä—è–º–æ –≤ —ç—Ç–æ–º –∫–æ–¥–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è.

import matplotlib.pyplot as plt ‚Äî –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤; –ø—Ä—è–º–æ –≤ —ç—Ç–æ–º –∫–æ–¥–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è.

from tqdm.notebook import tqdm ‚Äî –ø—Ä–æ–≥—Ä–µ—Å—Å‚Äë–±–∞—Ä, —É–¥–æ–±–Ω—ã–π –≤ Jupyter –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –∏—Ç–µ—Ä–∞—Ü–∏–π –æ–±—É—á–µ–Ω–∏—è/—Ç–µ—Å—Ç–∞.

### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
class MNIST_Multilayer_Perceptron(nn.Module): ‚Äî –æ–±—ä—è–≤–ª—è–µ—Ç –∫–ª–∞—Å—Å –º–æ–¥–µ–ª–∏ –∫–∞–∫ –Ω–∞—Å–ª–µ–¥–Ω–∏–∫–∞ nn.Module, —á—Ç–æ–±—ã PyTorch –º–æ–≥ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–ª–æ–∏ –∏ –∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ã.

def init(self): ‚Äî –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –∫–ª–∞—Å—Å–∞; –∑–¥–µ—Å—å —Å–æ–∑–¥–∞—é—Ç—Å—è –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è —Å–ª–æ–∏ –º–æ–¥–µ–ª–∏. –í–∞–∂–Ω–æ –∏–º–µ–Ω–Ω–æ –¥–≤–æ–π–Ω–æ–µ –ø–æ–¥—á—ë—Ä–∫–∏–≤–∞–Ω–∏–µ —Å –æ–±–µ–∏—Ö —Å—Ç–æ—Ä–æ–Ω.

super().init() ‚Äî –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑–æ–≤–æ–≥–æ nn.Module; —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ –ø–æ–¥–º–æ–¥—É–ª–µ–π.

self.net = nn.Sequential( ... ) ‚Äî –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç —Å–ª–æ–∏:

nn.Linear(784, 256) ‚Äî –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã–π —Å–ª–æ–π, –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ 28√ó28=784 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏ –≤—ã–≤–æ–¥–∏—Ç 256 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.

nn.ReLU() ‚Äî –Ω–µ–ª–∏–Ω–µ–π–Ω–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è –ø–æ—ç–ª–µ–º–µ–Ω—Ç–Ω–æ, –¥–æ–±–∞–≤–ª—è–µ—Ç –≤—ã—Ä–∞–∑–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å.

nn.Linear(256, 128) ‚Äî –≤—Ç–æ—Ä–æ–π –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã–π —Å–ª–æ–π: 256 ‚Üí 128.

nn.ReLU() ‚Äî –≤—Ç–æ—Ä–∞—è –Ω–µ–ª–∏–Ω–µ–π–Ω–æ—Å—Ç—å.

nn.Linear(128, 10) ‚Äî –≤—ã—Ö–æ–¥–Ω–æ–π —Å–ª–æ–π: 10 –ª–æ–≥–∏—Ç–æ–≤ (–ø–æ –æ–¥–Ω–æ–º—É –Ω–∞ –∫–ª–∞—Å—Å —Ü–∏—Ñ—Ä—ã 0‚Äì9).

def forward(self, x): ‚Äî –º–µ—Ç–æ–¥ –ø—Ä—è–º–æ–≥–æ –ø—Ä–æ—Ö–æ–¥–∞; –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –≤—ã—Ö–æ–¥–∞ –ø–æ –≤—Ö–æ–¥—É.

return self.net(x) ‚Äî –ø—Ä–æ–≥–æ–Ω—è–µ—Ç –≤—Ö–æ–¥ —á–µ—Ä–µ–∑ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–ª–æ—ë–≤ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ª–æ–≥–∏—Ç—ã –±–µ–∑ softmax (–æ–Ω –≤—Å—Ç—Ä–æ–µ–Ω –≤–Ω—É—Ç—Ä—å CrossEntropyLoss).

–í–∞–∂–Ω–æ: —Ä–∞–Ω–µ–µ —É –≤–∞—Å –±—ã–ª–∏ –æ—à–∏–±–∫–∏ –∏–∑‚Äë–∑–∞ –æ–ø–µ—á–∞—Ç–æ–∫ init –≤–º–µ—Å—Ç–æ init, super.init –≤–º–µ—Å—Ç–æ super().init –∏ –∏–∑‚Äë–∑–∞ —Ç–æ–≥–æ, —á—Ç–æ forward –±—ã–ª —Å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –æ—Ç—Å—Ç—É–ø–æ–º –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞. –≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ –ø—É—Å—Ç–æ–º—É —Å–ø–∏—Å–∫—É –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —É –º–æ–¥–µ–ª–∏ –∏ –æ—à–∏–±–∫–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä–∞. –í —Ä–∞–±–æ—á–µ–º –≤–∞—Ä–∏–∞–Ω—Ç–µ –∏–º—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞ –∏ super –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å –¥–≤–æ–π–Ω—ã–º–∏ –ø–æ–¥—á—ë—Ä–∫–∏–≤–∞–Ω–∏—è–º–∏, –∞ forward ‚Äî –Ω–∞ —Ç–æ–º –∂–µ —É—Ä–æ–≤–Ω–µ –æ—Ç—Å—Ç—É–ø–∞, —á—Ç–æ –∏ init.

### –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
mnist_train = datasets.MNIST(root="./datasets", train=True, transform=transforms.ToTensor(), download=True) ‚Äî –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—É—é —á–∞—Å—Ç—å MNIST –≤ –ø–∞–ø–∫—É ./datasets; ToTensor –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç PIL‚Äë–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ 28√ó28 –≤ —Ç–µ–Ω–∑–æ—Ä —Ñ–æ—Ä–º—ã —Å –Ω–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∑–Ω–∞—á–µ–Ω–∏–π –≤.

mnist_test = datasets.MNIST(root="./datasets", train=False, transform=transforms.ToTensor(), download=True) ‚Äî –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Ç–µ—Å—Ç–æ–≤—É—é —á–∞—Å—Ç—å –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ.

train_loader = torch.utils.data.DataLoader(mnist_train, batch_size=100, shuffle=True) ‚Äî –∏—Ç–µ—Ä–∞—Ç–æ—Ä –ø–æ –º–∏–Ω–∏‚Äë–±–∞—Ç—á–∞–º —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö: –ø–æ 100 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, —Å –ø–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏–µ–º –±–∞—Ç—á–µ–π –ø–µ—Ä–µ–¥ –∫–∞–∂–¥–æ–π —ç–ø–æ—Ö–æ–π.

test_loader = torch.utils.data.DataLoader(mnist_test, batch_size=100, shuffle=False) ‚Äî –∏—Ç–µ—Ä–∞—Ç–æ—Ä –ø–æ —Ç–µ—Å—Ç–æ–≤—ã–º –¥–∞–Ω–Ω—ã–º: –ø–æ 100 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –±–µ–∑ –ø–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏—è.

–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Å–æ–≤–µ—Ç: –∫ ToTensor() –æ–±—ã—á–Ω–æ –¥–æ–±–∞–≤–ª—è—é—Ç Normalize((0.1307,), (0.3081,)) –¥–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏–∏ MNIST, —á—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –æ–±—É—á–µ–Ω–∏—é.

### –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ –æ–±—É—á–µ–Ω–∏—è
model = MNIST_Multilayer_Perceptron() ‚Äî —Å–æ–∑–¥–∞—ë—Ç —ç–∫–∑–µ–º–ø–ª—è—Ä –úLP —Å —Ç—Ä–µ–º—è –ª–∏–Ω–µ–π–Ω—ã–º–∏ —Å–ª–æ—è–º–∏ –∏ –¥–≤—É–º—è ReLU.

criterion = nn.CrossEntropyLoss() ‚Äî —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å –¥–ª—è –º–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏; –æ–∂–∏–¥–∞–µ—Ç —Å—ã—Ä—ã–µ –ª–æ–≥–∏—Ç—ã —Ä–∞–∑–º–µ—Ä–∞ [batch, 10] –∏ —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ –∫–ª–∞—Å—Å–æ–≤ [batch].

optimizer = torch.optim.SGD(model.parameters(), lr=0.1) ‚Äî –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä —Å—Ç–æ—Ö–∞—Å—Ç–∏—á–µ—Å–∫–æ–≥–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–≥–æ —Å–ø—É—Å–∫–∞; –ø–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –º–æ–¥–µ–ª–∏ (–≤–µ—Å–∞ –∏ —Å–º–µ—â–µ–Ω–∏—è —Å–ª–æ—ë–≤) –∏ —à–∞–≥ –æ–±—É—á–µ–Ω–∏—è 0.1. –ü—Ä–∏ –∂–µ–ª–∞–Ω–∏–∏ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å momentum=0.9 –∏–ª–∏ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ Adam(lr=1e-3).

–ï—Å–ª–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è ValueError: optimizer got an empty parameter list, –ø–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞ –ø—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º, —á—Ç–æ —Å–ª–æ–∏ –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–∑‚Äë–∑–∞ init –≤–º–µ—Å—Ç–æ init) –∏–ª–∏ optimizer —Å–æ–∑–¥–∞—ë—Ç—Å—è –¥–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –º–æ–¥–µ–ª–∏. –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞ –∏ –ø–æ—Ä—è–¥–∫–∞ —Å—Ç—Ä–æ–∫ –æ—à–∏–±–∫–∞ –∏—Å—á–µ–∑–Ω–µ—Ç.

### –î–∞–ª—å–Ω–µ–π—à–∏–µ —à–∞–≥–∏ (–æ–±—É—á–∞—é—â–∏–π —Ü–∏–∫–ª)
–ü–µ—Ä–µ–¥ –æ–±—É—á–µ–Ω–∏–µ–º –≤–∫–ª—é—á–∞—é—Ç —Ä–µ–∂–∏–º –æ–±—É—á–µ–Ω–∏—è: model.train().

–í —Ü–∏–∫–ª–µ –ø–æ train_loader –Ω–∞ –∫–∞–∂–¥–æ–º –±–∞—Ç—á–µ:

optimizer.zero_grad() ‚Äî –æ–±–Ω—É–ª—è–µ—Ç –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã.

x = images.view(-1, 28*28) ‚Äî —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç –±–∞—Ç—á –∏–∑ —Ñ–æ—Ä–º—ã [B, 1, 28, 28] –≤ [B, 784] –¥–ª—è –ø–æ–¥–∞—á–∏ –≤ –ª–∏–Ω–µ–π–Ω—ã–π —Å–ª–æ–π.

y = model(x) ‚Äî –ø—Ä—è–º–æ–π –ø—Ä–æ—Ö–æ–¥, –ø–æ–ª—É—á–∞–µ–º –ª–æ–≥–∏—Ç—ã [B, 10].

loss = criterion(y, labels) ‚Äî –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –∫—Ä–æ—Å—Å‚Äë—ç–Ω—Ç—Ä–æ–ø–∏–∏.

loss.backward() ‚Äî –æ–±—Ä–∞—Ç–Ω–æ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤.

optimizer.step() ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.

### –û—Ü–µ–Ω–∫–∞ –Ω–∞ —Ç–µ—Å—Ç–µ
model.eval() ‚Äî –≤–∫–ª—é—á–∞–µ—Ç —Ä–µ–∂–∏–º –æ—Ü–µ–Ω–∫–∏ (–≤–∞–∂–Ω–æ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ Dropout/BatchNorm).

with torch.no_grad(): ‚Äî –æ—Ç–∫–ª—é—á–∞–µ—Ç –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤ –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ —Ä–µ—Å—É—Ä—Å–æ–≤.

–ü—Ä–æ–≥–æ–Ω –ø–æ test_loader: —Ä–∞–∑–≤–æ—Ä–æ—Ç –≤—Ö–æ–¥–∞, –ø—Ä—è–º–æ–π –ø—Ä–æ—Ö–æ–¥, preds = torch.argmax(y, dim=1), —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å labels –∏ –ø–æ–¥—Å—á—ë—Ç –¥–æ–ª–∏ –≤–µ—Ä–Ω—ã—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π.

**–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏:**
- –¢–∏–ø: –ú–Ω–æ–≥–æ—Å–ª–æ–π–Ω—ã–π –ø–µ—Ä—Å–µ–ø—Ç—Ä–æ–Ω (–Ω–µ–ª–∏–Ω–µ–π–Ω—ã–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä)
- –í—Ö–æ–¥–Ω–æ–π —Ä–∞–∑–º–µ—Ä: 784 (28√ó28 –ø–∏–∫—Å–µ–ª–µ–π)
- –í—ã—Ö–æ–¥–Ω–æ–π —Ä–∞–∑–º–µ—Ä: 10 (–∫–ª–∞—Å—Å—ã 0-9)
- –§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å: CrossEntropyLoss
- –û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä: SGD —Å learning rate = 0.1

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

- **–¢–æ—á–Ω–æ—Å—Ç—å –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö: ~91%**


## üë§ –ê–≤—Ç–æ—Ä

**–ö–∞–ø–Ω–∏–∫ –î–∞–Ω–∏–ª**

- GitHub: [@Gando4lapi](https://github.com/Gando4lapi)
- Email: kapnik.dan@gmail.com

---

**‚≠ê –ü–æ—Å—Ç–∞–≤—å—Ç–µ –∑–≤–µ–∑–¥–æ—á–∫—É, –µ—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç –±—ã–ª –ø–æ–ª–µ–∑–µ–Ω!**
